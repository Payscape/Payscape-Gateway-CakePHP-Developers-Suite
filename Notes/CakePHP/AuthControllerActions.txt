I have a "Posts" and a "Users" controller. I use the Auth Component and I want that all users can visit "Post.index" but only logged in users can visit "User.index".

In my app_controller.php I have this

$this->Auth->allow('signup', 'confirm', 'index');
but with that all users can visit post.index and user.index. How can I specify a Controller in the allow-method?

This didn't work for me:

$this->Auth->allow('signup', 'confirm', 'Post.index');
update I removed 'index' from the app_controller.php and instead set it in the beforeFilter method in the post controller:

function beforeFilter() 
{
    parent::beforeFilter();
    $this->Auth->allow('index');
}
I also set a variable "loggedIn" in app_controller, without calling "parent::beforeFilter();" I got an "undefined variable" notice.

thx sibidiba

authentication cakephp controller
share|improve this question
edited May 8 '10 at 14:17

asked May 8 '10 at 10:03

Christian Strang
1,42011325
2 Answers activeoldestvotes
up vote
5
down vote
accepted
The period will not work. You could try '/' instead. If that fails as well, you should set $this->Auth->allow('index') in PostController's and UserController's ::beforeFilter() individually. Don't forget to call parent::beforeFilter().

share|improve this answer
answered May 8 '10 at 13:41

sibidiba
2,3761424
Perfect answer! It didn't work with '/' so I removed 'index' from the app_controller and allowed it in the post controller: function beforeFilter() { parent::beforeFilter(); $this->Auth->allow('index'); } – Christian Strang May 8 '10 at 14:14

up vote
0
down vote
I am using CakePHP 2.x. The slash trick doesn't work.

If you want to allow user access "myController.myAction" without login, you should add beforeFilter() into myController.php instead of AppController.php

Here is the code to add into myController.php:

function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('myAction');
}