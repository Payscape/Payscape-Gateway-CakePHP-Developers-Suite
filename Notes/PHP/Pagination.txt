
<html>
<head>
 <title>Implementing Paging </title>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body>
<?php
 // host, username, password
 mysql_connect("localhost", "root", "1234");
 // select db
 mysql_select_db("image");

  // how many rows to show per page
  $rowsPerPage = 20;

 // by default we show first page
 $pageNum = 1;

 // if $_GET['page'] defined, use it as page number
   if(isset($_GET['page']))
   {
    $pageNum = $_GET['page'];
   }

// counting the offset
$offset = ($pageNum - 1) * $rowsPerPage;

$query  = "SELECT val FROM randoms LIMIT $offset, $rowsPerPage";
$result = mysql_query($query) or die('Error, query failed');

// print the random numbers
while($row = mysql_fetch_array($result))
{
 echo $row['val'] . '<br>';
}
echo '<br>';


 $numrows = mysql_num_rows($result);

// how many pages we have when using paging?

 // ceil rounds up to the next integer
 $maxPage = ceil($numrows/$rowsPerPage);

// print the link to access each page
$self = htmlentities($_SERVER['PHP_SELF']);
$nav = '';
for($page = 1; $page <= $maxPage; $page++)
{
	if ($page == $pageNum)
	{
		$nav .= " $page ";   // no need to create a link to current page
	}
	else
	{
		$nav .= " <a href=\"$self?page=$page\">$page</a> ";
	}		
}


// creating previous and next link
// plus the link to go straight to
// the first and last page

if ($pageNum > 1)
{
	$page = $pageNum - 1;
	$prev = " <a href=\"$self?page=$page\">[Prev]</a> ";
	
	$first = " <a href=\"$self?page=1\">[First Page]</a> ";
} 
else
{
	$prev  = '&nbsp;'; // we're on page one, don't print previous link
	$first = '&nbsp;'; // nor the first page link
}

if ($pageNum < $maxPage)
{
	$page = $pageNum + 1;
	$next = " <a href=\"$self?page=$page\">[Next]</a> ";
	
	$last = " <a href=\"$self?page=$maxPage\">[Last Page]</a> ";
} 
else
{
	$next = '&nbsp;'; // we're on the last page, don't print next link
	$last = '&nbsp;'; // nor the last page link
}

// print the navigation link
echo $first . $prev . $nav . $next . $last;

// and close the database connection
 mysql_close($conn);

?>
</body>
</html>

